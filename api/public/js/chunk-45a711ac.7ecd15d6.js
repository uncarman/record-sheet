(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-45a711ac"],{"2c0a":function(e,t,a){"use strict";a.d(t,"c",function(){return n}),a.d(t,"a",function(){return o}),a.d(t,"d",function(){return i}),a.d(t,"b",function(){return c}),a.d(t,"e",function(){return l});var r=a("9bd2");function n(e){return Object(r.a)({url:"/locations",method:"get",params:e})}function o(e){return Object(r.a)({url:"/locations/".concat(e),method:"delete"})}function i(e){return Object(r.a)({url:"/locations",method:"post",data:e})}function c(e){return Object(r.a)({url:"/locations/".concat(e),method:"get"})}function l(e,t){return Object(r.a)({url:"/locations/".concat(e),method:"put",data:t})}},"2f75":function(e,t,a){"use strict";a.d(t,"d",function(){return n}),a.d(t,"b",function(){return o}),a.d(t,"e",function(){return i}),a.d(t,"c",function(){return c}),a.d(t,"f",function(){return l}),a.d(t,"a",function(){return s});var r=a("9bd2");function n(e){return Object(r.a)({url:"/devices",method:"get",params:e})}function o(e){return Object(r.a)({url:"/devices/".concat(e),method:"delete"})}function i(e){return Object(r.a)({url:"/devices",method:"post",data:e})}function c(e){return Object(r.a)({url:"/devices/".concat(e),method:"get"})}function l(e,t){return Object(r.a)({url:"/devices/".concat(e),method:"put",data:t})}function s(e){return Object(r.a)({url:"/devices/batchUpdate",method:"post",data:e})}},"46a4":function(e,t,a){"use strict";var r=a("7075");a.n(r).a},7075:function(e,t,a){},f3ae:function(e,t,a){"use strict";a.r(t);a("7f7f");var r=a("2c0a"),n=a("2f75"),o=a("5c96"),i={name:"page",data:function(){return{types:["电梯","灭火器","消防栓","故障报修"],locations:[],form:{name:"",sn:"",type:"",location_id:"",model:"",expired_at:"",desc:"",check_items:[{name:""}],image:"",interval:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],sn:[{required:!0,message:"请输入编号",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],location_id:[{required:!0,message:"请选择所在位置",trigger:"change"}],expired_at:[{required:!0,message:"请选择有效期",trigger:"change"}],image:[{required:!0,message:"请选择图片",trigger:"change"}],interval:[{required:!0,message:"请填写检查周期",trigger:"change"}]},updateLoading:!1,device_id:""}},created:function(){this.device_id=this.$route.params.id,this.requestLocations(),this.requestDevice()},methods:{requestLocations:function(){var t=this;Object(r.c)({is_all:1}).then(function(e){t.locations=e.data})},requestDevice:function(){var t=this;Object(n.c)(this.device_id).then(function(e){t.form.name=e.data.name,t.form.sn=e.data.sn,t.form.type=e.data.type,t.form.location_id=e.data.location.id,t.form.model=e.data.model,t.form.expired_at=e.data.expired_at,t.form.check_items=e.data.check_items,t.form.desc=e.data.desc,t.form.image=e.data.image,t.form.interval=e.data.interval})},addCheckItem:function(){this.form.check_items.push({name:""})},requestUpdate:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.updateLoading||(t.updateLoading=!0,Object(n.f)(t.device_id,t.form).then(function(e){t.updateLoading=!1,Object(o.Message)({message:e.message,type:"success",duration:3e3})}).catch(function(){t.updateLoading=!1}))})},handleFileChange:function(e){var t=this,a=new FileReader;a.readAsDataURL(e.raw),a.onload=function(){t.form.image=a.result}}}},c=(a("46a4"),a("2877")),l=function(e){e.options.__source="src/views/devices/edit/page.vue"},s=Object(c.a)(i,function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("d2-container",[n("el-row",{staticClass:"d2-mt d2-mb"},[n("el-col",[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:r.updateLoading,expression:"updateLoading"}],ref:"form",attrs:{refs:"form",rules:r.rules,model:r.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-col",{attrs:{span:12}},[n("el-input",{model:{value:r.form.name,callback:function(e){r.$set(r.form,"name",e)},expression:"form.name"}})],1)],1),n("el-form-item",{attrs:{label:"图片",prop:"image"}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"auto-upload":!1,"on-change":r.handleFileChange}},[r.form.image?n("img",{staticClass:"avatar",attrs:{src:r.form.image}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),n("el-form-item",{attrs:{label:"编号",prop:"sn"}},[n("el-col",{attrs:{span:12}},[n("el-input",{model:{value:r.form.sn,callback:function(e){r.$set(r.form,"sn",e)},expression:"form.sn"}})],1)],1),n("el-form-item",{attrs:{label:"类型",prop:"type"}},[n("el-select",{attrs:{placeholder:"请选择类型"},model:{value:r.form.type,callback:function(e){r.$set(r.form,"type",e)},expression:"form.type"}},r._l(r.types,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),n("el-form-item",{attrs:{label:"所在位置",prop:"location_id"}},[n("el-select",{attrs:{placeholder:"请选择所在位置"},model:{value:r.form.location_id,callback:function(e){r.$set(r.form,"location_id",e)},expression:"form.location_id"}},r._l(r.locations,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),n("el-form-item",{attrs:{label:"型号",prop:"model"}},[n("el-col",{attrs:{span:12}},[n("el-input",{model:{value:r.form.model,callback:function(e){r.$set(r.form,"model",e)},expression:"form.model"}})],1)],1),n("el-form-item",{attrs:{label:"有效期",prop:"expired_at"}},[n("el-col",{attrs:{span:12}},[n("el-date-picker",{attrs:{type:"date",placeholder:"请选择有效期","value-format":"yyyy-MM-dd"},model:{value:r.form.expired_at,callback:function(e){r.$set(r.form,"expired_at",e)},expression:"form.expired_at"}})],1)],1),n("el-form-item",{attrs:{label:"检查周期(天)",prop:"interval"}},[n("el-col",{attrs:{span:12}},[n("el-input",{model:{value:r.form.interval,callback:function(e){r.$set(r.form,"interval",e)},expression:"form.interval"}})],1)],1),n("el-form-item",{attrs:{label:"检查项"}},[n("el-col",{attrs:{span:12}},[r._l(r.form.check_items,function(t,a){return n("el-row",{key:a,staticClass:"d2-mt-10 d2-mb-10"},[n("el-col",{staticClass:"d2-mr-10",attrs:{span:21}},[n("el-input",{model:{value:t.name,callback:function(e){r.$set(t,"name",e)},expression:"item.name"}})],1),n("el-col",{attrs:{span:2}},[n("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-remove"},on:{click:function(e){return r.form.check_items.splice(a,1)}}})],1)],1)}),n("el-button",{attrs:{icon:"el-icon-plus"},on:{click:r.addCheckItem}},[r._v("增加一项")])],2)],1),n("el-form-item",{staticClass:"ueditor-form-item",attrs:{label:"设备描述",prop:"desc"}},[n("d2-ueditor",{model:{value:r.form.desc,callback:function(e){r.$set(r.form,"desc",e)},expression:"form.desc"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:r.requestUpdate}},[r._v("保存")])],1)],1)],1)],1)],1)},[],!1,null,null,null);"function"==typeof l&&l(s);t.default=s.exports}}]);